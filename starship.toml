# Starship configuration with enhanced git information

# Global timeout setting to prevent hanging
command_timeout = 5000

# Disable modules that might cause timeouts
[bun]
disabled = true

[git_status]
# Oh-my-zsh style git status
format = '([$all_status$ahead_behind]($style))'
style = "red"

# Oh-my-zsh symbols
staged = "+"           # Files ready to commit
modified = "!"         # Files changed but not staged
untracked = "?"        # Files not tracked by git
deleted = "âœ–"          # Files deleted
renamed = "âžœ"          # Files renamed
stashed = "$"          # Stash indicator
ahead = "â‡¡"            # Commits ahead of remote
behind = "â‡£"           # Commits behind remote
up_to_date = "âœ“"       # Clean when up to date
diverged = "â‡•"         # When both ahead and behind
conflicted = "âœ—"       # Merge conflicts
typechanged = ""       # Type changes
disabled = false

[git_metrics]
# Show number of files changed instead of line counts
added_style = "bold green"
deleted_style = "bold red"
only_nonzero_diffs = true
format = "([+$added files]($added_style) )([-$deleted files]($deleted_style) )"
disabled = true
ignore_submodules = false

[git_commit]
# Show commit hash when in detached HEAD
commit_hash_length = 7
format = '[\($hash$tag\)]($style) '
style = "green bold"
only_detached = true
disabled = false
tag_symbol = " ðŸ·  "
tag_disabled = true

[git_branch]
# Oh-my-zsh style branch display
format = "on [$symbol$branch]($style) "
symbol = " "
style = "blue"
truncation_length = 9223372036854775807
truncation_symbol = "â€¦"
only_attached = false
always_show_remote = false
disabled = false

[git_state]
# Show current git operation state
rebase = "REBASING"
merge = "MERGING"
revert = "REVERTING"
cherry_pick = "CHERRY-PICKING"
bisect = "BISECTING"
am = "AM"
am_or_rebase = "AM/REBASE"
style = "bold yellow"
format = '\([$state( $progress_current/$progress_total)]($style)\) '
disabled = false

# Custom git file changes (shows number of files, not lines)
[custom.git_files]
command = '''
if git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
  added=$(git diff --cached --name-only 2>/dev/null | wc -l | tr -d ' ')
  modified=$(git diff --name-only 2>/dev/null | wc -l | tr -d ' ')
  output=""
  if [ "$added" -gt 0 ]; then
    output="$output+$added"
  fi
  if [ "$modified" -gt 0 ]; then
    if [ -n "$output" ]; then output="$output "; fi
    output="$output~$modified"
  fi
  echo "$output"
fi
'''
when = "git rev-parse --is-inside-work-tree"
style = "green bold"
format = "[$output]($style) "
description = "Show number of files added/modified"

# Custom git stash count
[custom.git_stash]
command = '''
if git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
  stash_count=$(git stash list 2>/dev/null | wc -l | tr -d ' ')
  if [ "$stash_count" -gt 0 ]; then
    echo "âš‘$stash_count"
  fi
fi
'''
when = "git rev-parse --is-inside-work-tree"
style = "yellow bold"
format = "[$output]($style) "
description = "Show git stash count"

# Additional git information modules
[package]
# Show package version if in a project
format = "is [$symbol$version]($style) "
symbol = "ðŸ“¦ "
style = "208 bold"
display_private = false
disabled = false